<div class="c-parsce-modal">

  <div class="modal-header c-parsce-modal__header">
    CREATE A PARAMETER SCENARIO
  </div>

  <form name="manageScenarioForm" class="modal-body c-parsce-modal__body"
        novalidate ng-submit="manageScenario()">

    <div class="c-parsce-modal__field-wrap">
      <label class="c-parsce-modal__label"> Name </label>
      <input class="c-parsce-modal__input txbox" type="text" ng-model="scenario.name" required/>
      <div class="error-hint" ng-show="scenarioExists()">
        Scenario with this name already exists, please choose a different name.
      </div>
    </div>

    <div class="c-parsce-modal__field-wrap">
      <label class="c-parsce-modal__label"> Select a parameter set to use as baseline </label>
      <select class="c-parsce-modal__input txbox" type="text" ng-model="scenario.parset_id" ng-init="scenario.parset_id = parsets[0].id" ng-options="parset.id as parset.name for parset in parsets"
       required>
      </select>
    </div>

    <table class="table table-bordered" style="margin-bottom:0">
      <tr>
        <th style="width: 300px;">Model Parameters</th>
        <th style="width: 300px;">Population</th>
        <th style="width: 150px;">Start Year</th>
        <th style="width: 100px;">Final Year</th>
        <th style="width: 150px;">Start Value</th>
        <th style="width: 150px;">Final Value</th>
        <th style="width: 150px;">Manage</th>
      </tr>
      <tr ng-repeat="par in scenario.pars">
        <td>{{par.name}}</td>
        <td>{{par.for}}</td>
        <td>{{par.startyear}}</td>
        <td>{{par.endyear}}</td>
        <td>{{par.startval}}</td>
        <td>{{par.endval}}</td>
        <td>
          <i class="fa fa-times" ng-click="removeParam(scenario, $index)"></i>
        </td>
      </tr>
      <tr>
        <td>
          <select class="txbox __inline __m" type="text" ng-model="editPar.name"
                  ng-options="param.short as param.name for param in parsForSelectedParset()"
                  ng-init="editPar.name = parsForSelectedParset()[0].short" />
        </td>
        <td>
          <select class="txbox __inline __m" type="text" ng-model="editPar.for"
                  ng-options="pop.val as pop.label for pop in popsForParam(editPar.name)"
                  ng-init="editPar.for = popsForParam(parsForSelectedParset()[0].short)[0].label" />
        </td>
        <td><input class="txbox __inline __m" ng-model="editPar.startyear" type="number"/></td>
        <td><input class="txbox __inline __m" ng-model="editPar.endyear" type="number"/></td>
        <td><input class="txbox __inline __m" ng-model="editPar.startval" type="number"/></td>
        <td><input class="txbox __inline __m" ng-model="editPar.endval" type="number"/></td>
        <td>
          <button type="button" ng-click="addPar()" class="btn">add</button>
        </td>

      </tr>
    </table>

    <div class="o-form__wrap" ng-repeat="rs in scenario.pars track by $index">
      <div class="o-card c-parsce-modal__card">
        <div class="c-parsce-modal__subform">

          <!-- Parameters -->
          <div class="c-parsce-modal__field-wrap">
            <label class="c-parsce-modal__label"> Parameters </label>
            <select class="c-parsce-modal__input txbox" type="text" ng-model="rs.name" required ng-options="param.short as param.name for param in parsForSelectedParset()">
              <option value=""> -- Select --</option>
            </select>
          </div>

          <!-- For -->
          <div class="c-parsce-modal__field-wrap">
            <label class="c-parsce-modal__label"> For </label>
            <select class="c-parsce-modal__input txbox" type="text" ng-model="rs.for" required ng-options="pop.val as pop.label for pop in popsForParam(rs.name)">
              <option value=""> -- Select --</option>
            </select>
          </div>

          <!-- Start year of scenario  -->
          <div class="c-parsce-modal__field-wrap">
            <label class="c-parsce-modal__label"> Start year of scenario </label>
            <input class="c-parsce-modal__input c-parsce-modal__input--small txbox" ng-model="rs.startyear" type="number" required min="0"/>
          </div>

          <!-- Final year of scenario  -->
          <div class="c-parsce-modal__field-wrap">
            <label class="c-parsce-modal__label"> Final year of scenario </label>
            <input class="c-parsce-modal__input c-parsce-modal__input--small txbox" ng-model="rs.endyear" type="number" required min="0"/>
          </div>

          <!-- Value at start of scenario  -->
          <div class="c-parsce-modal__field-wrap">
            <label class="c-parsce-modal__label"> Value at start of scenario </label>
            <input class="c-parsce-modal__input txbox" type="number"  ng-model="rs.startval" required/>
          </div>

          <!-- Value at end of scenario  -->
          <div class="c-parsce-modal__field-wrap">
            <label class="c-parsce-modal__label"> Value at end of scenario </label>
            <input class="c-parsce-modal__input txbox" type="number"  ng-model="rs.endval" required/>
          </div>

        </div>
        <div class="o-card__delete" ng-click="removeParam(scenario, $index)">x</div>
      </div>
    </div>

    <button type="button" class="btn c-parsce-modal__button c-parsce-modal__button--add-parameter" ng-disabled="!scenario.parset_id" ng-click="addParam(scenario)">
      Add parameter
    </button>

    <div class="c-parsce-modal__buttons u-layout-horizontal">
      <button type="submit" ng-disabled="manageScenarioForm.$invalid || scenarioExists()" class="btn __s c-parsce-modal__button c-parsce-modal__button--save">
        Save
      </button>
    </div>

  </form>

</div>
