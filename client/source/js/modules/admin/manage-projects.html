<div class="rish">
  <h3>Manage projects</h3>
  <div class="section" ng-show="!users.length"> No other users have projects. </div>
  <div class="section" ng-show="users.length" ng-repeat="user in ::users">
    <h4> {{ ::user.data.username }} {{ ::user.data.displayName }} ({{ ::user.data.email }}) </h4>
    <table ng-show="user.projects.length" class="table table-bordered table-hover table-striped" style="width: auto">
      <thead>
      <tr>
        <th>Name</th>
        <th>Populations</th>
        <th>Programs</th>
        <th>Data start year</th>
        <th>Data end year</th>
        <th>Project created on</th>
        <th>Data uploaded on</th>
        <th colspan="7">Actions</th>
      </tr>
      </thead>
      <tbody>
      <tr ng-repeat="project in user.projects | orderBy: 'name'">
        <td>
          {{ ::project.name }}
        </td>
        <td>
          {{ ::project.populations.length }}
        </td>
        <td>
          {{ ::project.nProgram }}
        </td>
        <td>
          {{ ::project.dataStart }}
        </td>
        <td>
          {{ ::project.dataEnd }}
        </td>
        <td>
          {{ ::project.creationTime| date:'yyyy-MM-dd HH:mm:ss'}}
        </td>
        <td>
          {{ project.dataUploadTime ? (project.dataUploadTime | date:'yyyy-MM-dd HH:mm:ss') : 'No data uploaded'}}
        </td>
        <td>
          <button class="btn __green" ng-click="open(project.name, project.id)">Open project</button>
        </td>
        <td>
          <button class="btn __blue" ng-click="edit(project.name, project.id)">Edit project</button>
        </td>
        <td>
          <button class="btn __red" ng-click="remove($event, user, project.name, project.id, $index)">Delete project</button>
        </td>
        <td>
          <button class="btn __blue" ng-click="getData(project.name, project.id)">Download project</button>
        </td>
        <td>
          <button class="btn __blue" ng-click="workbook(project.name, project.id)">Download data entry spreadsheet
          </button>
        </td>
      </tr>
      </tbody>
    </table>
    <div ng-show="user.projects.length === 0">
      <h3>No projects found for this user</h3>
    </div>
  </div>
</div>
