from collections import defaultdictfrom optima.project import Projectfrom optima.defaultprograms import defaultprogramsfrom server.webapp.populations import project_population_data, population_keysdef get_default_programs(project=None):    if project is None:        project = Project()        project.data['pops'] = project_population_data()        project.data['pships'] = {}        for key in ['cas', 'com', 'inj', 'reg']:            project.data['pships'][key] = population_keys()        project.data['npops'] = len(project.data['pops']['short'])    programs = defaultprograms(project)    rv = []    for program in programs:        rv.append({            'active': False,            'category': program.category,            'name': program.name,            'short_name': program.short_name,            'populations': program.targetpops,            'parameters': [{                'active': False,                'param': parameter['param'],                'pops': [parameter['pop']]                    if type(parameter['pop']) == str                    else list(parameter['pop']),            } for parameter in program.targetpars],            'criteria': program.criteria,        })    return rvprogram_list = get_default_programs()def programs_for_input_key(key, programs=None):  # params is the output of parameters.parameters() method    from parameters import input_parameters    if not programs or not any(item for item in programs):        programs = program_list    params = input_parameters(key)    result = defaultdict(list)    keys = None    for param in params:        keys = param.get('keys')        if keys is not None:            for program in programs:                program_name = program['short_name']                for parameter in program['parameters']:                    if parameter['param'] == keys:                        pops = parameter['pop']                        if pops and pops != ['']:                            result[program_name].extend(pops)    return resultdef program_categories():    result = []    next_category = None    for p in program_list:        current_category = p['category']        if next_category is not None and next_category['category'] == current_category:            next_category['programs'].append({'short_name': p['short_name'], 'name': p['name']})        else:            if next_category is not None:                result.append(next_category)            next_category = {'category':current_category}            next_category['programs'] = []    if next_category is not None: result.append(next_category)    return result